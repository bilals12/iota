replicaCount: 1

image:
  repository: iota
  pullPolicy: IfNotPresent
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations:
    # eks.amazonaws.com/role-arn: arn:aws:iam::123456789012:role/iota-role
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: false
  allowPrivilegeEscalation: false

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

nodeSelector: {}

tolerations: []

affinity: {}

# Detection engine configuration
detection:
  mode: watch
  python: python3
  enginePath: /app/engines/iota/engine.py

  # Rules configuration
  rules:
    # Git repository URL for detection rules
    repo: ""
    # Branch to clone
    branch: main
    # Path within repo to rules directory
    path: rules
    # Sync interval (how often to pull latest rules)
    syncInterval: 5m

  # Events directory (shared volume for CloudTrail logs)
  eventsDir: /data/events

  # State database
  stateFile: /data/state/iota.db

# Slack integration
slack:
  enabled: false
  # Reference to sealed secret containing webhook URL
  secretName: iota-slack-webhook
  secretKey: webhook-url

# Persistent volume for events (shared with log shipper)
persistence:
  events:
    enabled: true
    # Use existing claim (shared with CloudTrail log shipper)
    existingClaim: ""
    storageClass: ""
    accessMode: ReadWriteMany
    size: 10Gi

  state:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 1Gi

# Init container for cloning rules repo
initContainers:
  gitSync:
    enabled: true
    image: alpine/git:latest
    imagePullPolicy: IfNotPresent
